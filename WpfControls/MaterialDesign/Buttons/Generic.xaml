<ResourceDictionary
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="clr-namespace:WpfControls.MaterialDesign.Buttons"
    xmlns:sys="clr-namespace:System;assembly=mscorlib">

    <!-- 基础样式模板 -->
    <Style TargetType="{x:Type local:ThemableButton}">
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type local:ThemableButton}">
                    <Grid>
                        <!-- 按钮主体 -->
                        <Border 
                            x:Name="PART_Border"
                            Background="{TemplateBinding Background}"
                            BorderBrush="{TemplateBinding BorderBrush}"
                            BorderThickness="{TemplateBinding BorderThickness}"
                            CornerRadius="{TemplateBinding CornerRadius}">

                            <!-- 内容布局 -->
                            <StackPanel Orientation="Horizontal" 
                                        Margin="{TemplateBinding Padding}"
                                        HorizontalAlignment="Center"
                                        VerticalAlignment="Center">

                                <!-- 图标 (可选) -->
                                <Image Source="{TemplateBinding Icon}" 
                                       Width="16" Height="16" 
                                       Margin="0,0,5,0"
                                       Visibility="{Binding Icon, 
                                            RelativeSource={RelativeSource TemplatedParent},
                                            Converter={StaticResource NullToVisibilityConverter}}"/>

                                <!-- 文本内容 -->
                                <ContentPresenter 
                                    HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                    VerticalAlignment="{TemplateBinding VerticalContentAlignment}"/>
                            </StackPanel>
                        </Border>

                        <!-- 徽章 (可选) -->
                        <TextBlock x:Name="PART_Badge"
                                   Text="{TemplateBinding BadgeText}"
                                   Visibility="Collapsed"
                                   HorizontalAlignment="Right"
                                   VerticalAlignment="Top"
                                   Margin="-5,-5,0,0"
                                   Padding="2,1"
                                   Background="Red"
                                   Foreground="White"
                                   FontSize="10"
                                   MinWidth="16"
                                   TextAlignment="Center"/>
                    </Grid>

                    <!-- 触发器 -->
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsMouseOver" Value="True">
                            <Setter TargetName="PART_Border" Property="Background" Value="#E0E0E0"/>
                        </Trigger>
                        <Trigger Property="IsPressed" Value="True">
                            <Setter TargetName="PART_Border" Property="Background" Value="#C0C0C0"/>
                        </Trigger>
                        <Trigger Property="IsEnabled" Value="False">
                            <Setter TargetName="PART_Border" Property="Opacity" Value="0.5"/>
                        </Trigger>
                        <!-- 徽章显示触发器 -->
                        <Trigger Property="BadgeText" Value="{x:Null}">
                            <Setter TargetName="PART_Badge" Property="Visibility" Value="Collapsed"/>
                        </Trigger>
                        <Trigger Property="BadgeText" Value="">
                            <Setter TargetName="PART_Badge" Property="Visibility" Value="Collapsed"/>
                        </Trigger>
                        <Trigger Property="BadgeText" Value="{x:Static sys:String.Empty}">
                            <Setter TargetName="PART_Badge" Property="Visibility" Value="Collapsed"/>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

</ResourceDictionary>
